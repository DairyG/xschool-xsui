<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8" />
		<title></title>
		<link rel="stylesheet" href="../../layui/css/layui.css" />
		<link rel="stylesheet" href="../../layui/css/common.css" />
		<link rel="stylesheet" href="../../layui/css/liucheng.css" />
		<script type="text/javascript" src="../../lib/jquery-1.8.3.min.js"></script>
		<script type="text/javascript" src="../../layui/layui.js"></script>
		<script type="text/javascript" src="../../js/common.js"></script>
	</head>
	<body class="bgf2f2f2">
		<div class="childrenBody">
			<div class="layui-card-body bgwhite">
				<div class="layui-tab" lay-filter="component-tabs-brief">
					<ul class="layui-tab-title">
						<li class="layui-this">基本信息</li>
						<li>内容设计</li>
						<li>流程设计</li>
						<span class="layui-btn fr" onclick="history.back(-1)">返回</span>
					</ul>
					<div class="layui-tab-content">
						<div class="layui-tab-item layui-show" tab-name="基本信息">
							<form class="layui-form layui-form2">
								<div class="layui-row">
									<div class="layui-form-item layui-col-md12 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>流程名称</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入流程名称" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>流程类型</label>
										<div class="layui-input-block">
											<select>
												<option>事务流程</option>
												<option>请款流程</option>
												<option>付款流程</option>
											</select>
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>所属分组</label>
										<div class="layui-input-block">
											<select>
												<option>请选择分组</option>
												<option>用车申请</option>
												<option>招聘申请</option>
											</select>
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>可见范围</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请选择可见范围" autocomplete="off" class="layui-input" onclick="user_popup()"/>
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label">流程图标</label>
										<div class="layui-input-block">
											<div class="margin-t-3">
												<span class="layui-btn layui-btn-sm layui-btn-normal">上传图标</span>
											</div>
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label">流程描述</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入流程描述" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label">审批意见</label>
										<div class="layui-input-block">
											<input type="checkbox" title="必填" lay-skin="primary" />
										</div>
									</div>
								</div>
								<div class="layui-row text-right">
									<button class="layui-btn layui-btn-danger" lay-submit lay-filter="submit">下一步</button>
									<span class="layui-btn" onclick="history.back(-1)">返回</span>
								</div>
							</form>
						</div>
						<div class="layui-tab-item" tab-name="内容设计">
							<form class="layui-form layui-form2">
								<div class="layui-row">
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>请款编号</label>
										<div class="layui-input-block">
											<input type="text" class="layui-input" readonly onclick="show_search()" />
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label">合同编号</label>
										<div class="layui-input-block">
											<input type="text" name="title" required readonly lay-verify="required" placeholder="合同编号" autocomplete="off" class="layui-input">
										</div>
									</div>
									<!-- 付款次数 在关联了请款单号后才显示 -->
									<!-- 有合同时 -->
									<div class="layui-form-item layui-col-md12" id="pay_table_item" >
										<label class="layui-form-label">付款次数：</label>
										<div class="layui-input-block">
											<table class="layui-table">
												<thead>
													<tr>
														<th>款项名称</th>
														<th>比例</th>
														<th>金额</th>
														<th>付款日期</th>
														<th>备注</th>
													</tr>
												</thead>
												<tbody>
													<tr>
														<td>首款</td>
														<td>30%</td>
														<td>300000</td>
														<td>2019-05-01</td>
														<td>首次验收通过付款</td>
													</tr>
													<tr>
														<td>中期款</td>
														<td>60%</td>
														<td>600000</td>
														<td>2019-09-01</td>
														<td>项目验收通过付款</td>
													</tr>
													<tr>
														<td>中期款</td>
														<td>10%</td>
														<td>100000</td>
														<td>2019-10-01</td>
														<td>项目正式交付付款</td>
													</tr>
												</tbody>
											</table>
										</div>
									</div>
									<div class="layui-form-item layui-col-md12" id="pay_table_item" >
										<label class="layui-form-label">已付款记录：</label>
										<div class="layui-input-block">
											<table class="layui-table">
												<thead>
													<tr>
														<th>款项名称</th>
														<th>申请金额</th>
														<th>实际付款</th>
														<th>付款凭证</th>
														<th>付款日期</th>
														<th>备注</th>
													</tr>
												</thead>
												<tbody>
													<tr>
														<td>首款</td>
														<td>300000</td>
														<td>300000</td>
														<td>1242353423</td>
														<td>2019-05-01</td>
														<td>首次验收通过付款</td>
													</tr>
													<tr>
														<td>中期款</td>
														<td>600000</td>
														<td>600000</td>
														<td>2535345346</td>
														<td>2019-09-01</td>
														<td>项目验收通过付款</td>
													</tr>
													<tr>
														<td>中期款</td>
														<td>100000</td>
														<td>100000</td>
														<td>4423535234</td>
														<td>2019-10-01</td>
														<td>项目正式交付付款</td>
													</tr>
												</tbody>
											</table>
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>费用项目</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入费用项目" autocomplete="off" class="layui-input">
										</div>
									</div>
									<!-- 付款方式为现金时银行账号和银行名称不必填 -->
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>付款方式</label>
										<div class="layui-input-block">
											<select>
												<option>请选择付款方式</option>
												<option>转账</option>
												<option>现金</option>
											</select>
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>收款公司名称</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入公司名称" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>收款公司开户银行</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入开户银行" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>收款公司银行账号</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入银行账号" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>合同总金额</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入合同总金额" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>已付金额</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入已付金额" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label"><span class="text-red"> *</span>本次付款金额</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入本次付款金额" autocomplete="off" class="layui-input">
										</div>
									</div>
									<div class="layui-form-item layui-col-md6 margin-b-20">
										<label class="layui-form-label">处理时效</label>
										<div class="layui-input-block">
											<!-- 普通 48小时内处理 紧急 24小时内处理 -->
											<select>
												<option>普通</option>、
												<option>紧急</option>
											</select>
										</div>
									</div>
									<div class="layui-form-item layui-col-md12 margin-b-20">
										<label class="layui-form-label">付款备注</label>
										<div class="layui-input-block">
											<input type="text" name="title" required  lay-verify="required" placeholder="请输入付款备注" autocomplete="off" class="layui-input">
										</div>
									</div>
								</div>
								<div class="layui-row">
									<div class="layui-form-item">
										<div class="layui-input-block text-right">
											<button class="layui-btn layui-btn-danger" lay-submit lay-filter="submit">确定</button>
											<span class="layui-btn" onclick="history.back(-1)">返回</span>
										</div>
									</div>
								</div>
							</form>
						</div>
						<div class="layui-tab-item" tab-name="流程设计">
							<form class="layui-form process_add_form">
								<div class="layui-form-item">
									<div style="width: 400px;margin:0 auto">
										<ul class="process_box">
											<li>
												<div class="layui-card faqi_card">
													<div class="layui-card-header">发起人</div>
													<div class="layui-card-body">
														<div class="show_div">
															所有人
														</div>
													</div>
												</div>
												<div class="process_add_btn_item">
													<label>
														<i class="layui-icon layui-icon-add-circle" onclick="show_add_item(this)"></i>
														<input type="radio" name="add_item_point" lay-ignore />
													</label>
												</div>
											</li>
											<li>
												<div class="layui-card shenpi_card">
													<div class="layui-card-header">审批人</div>
													<div class="layui-card-body">
														<div class="show_div"><span class="text-85">请选择审批人</span></div>
														<label class="add_icon text-85">
															<i class="layui-icon layui-icon-right fr fontsize-18"></i>
															<input type="radio" name="add_item_point" lay-ignore  onclick="on_select(this)"/>
														</label>
													</div>
												</div>
												<div class="process_add_btn_item">
													<label>
														<i class="layui-icon layui-icon-add-circle" onclick="show_add_item(this)"></i>
														<input type="radio" name="add_item_point" lay-ignore />
													</label>
												</div>
											</li>
											<li>
												<div class="layui-card cahosong_card">
													<div class="layui-card-header">抄送人<i class="layui-icon layui-icon-close-fill fr fontsize-18" onclick="close_item(this)"></i></div>
													<div class="layui-card-body">
														<!-- 一个人时显示 人名称 多个人时显示人数+会签（例 4人会签） -->
														<div class="show_div"><span class="text-85">请选择抄送人</span></div>
														<label class="add_icon text-85">
															<i class="layui-icon layui-icon-right fr fontsize-18"></i>
															<input type="radio" name="add_item_point" lay-ignore  onclick="on_select(this)"/>
														</label>
													</div>
												</div>
												<div class="process_add_btn_item">
													<label>
														<i class="layui-icon layui-icon-add-circle" onclick="show_add_item(this)"></i>
														<input type="radio" name="add_item_point" lay-ignore />
													</label>
												</div>
											</li>
											<li>
												<div class="layui-card fupan_card">
													<div class="layui-card-header">复盘人</div>
													<div class="layui-card-body text-center">
														<input type="checkbox" title="发起人必填" lay-skin="primary" />
														<input type="checkbox" title="部门经理必填" lay-skin="primary"/>
													</div>
												</div>
												<div class="process_add_btn_item process_add_btn_item_end">
												</div>
												<p class="text-center text-85">流程结束</p>
											</li>
										</ul>
									</div>
								</div>
								<div class="layui-row text-right">
									<button class="layui-btn layui-btn-danger" lay-submit lay-filter="submit">确认</button>
									<span class="layui-btn" onclick="history.back(-1)">返回</span>
								</div>
							</form>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="linePop linePop1">
			<div class="layui-card-body padding-r-50">
				<form class="layui-form layui-form2" >
					<div class="layui-row">
						<div class="layui-form-item layui-col-md12 margin-b-20">
							<label class="layui-form-label"><span class="text-red"> *</span>分组名称</label>
							<div class="layui-input-block">
								<input type="text" name="title" required  lay-verify="required" placeholder="请输入分组名称" autocomplete="off" class="layui-input">
							</div>
						</div>
					</div>	
					<div class="layui-row text-right">
						<button class="layui-btn" lay-submit="" lay-filter="formDemo">确认</button>
						<span class="layui-btn layui-btn-primary" onclick="closePop()">返回</span>
					</div>
				</form>
			</div>
		</div>
		<div class="linePop linePop2">
			<div class="layui-card-body padding-r-50">
				<form class="layui-form layui-form2" >
					<div class="layui-row">
						<div class="layui-form-item layui-col-md12 margin-b-20">
							<label class="layui-form-label"><span class="text-red"> *</span>分组</label>
							<div class="layui-input-block">
								<select>
									<option></option>
									<option>用车申请</option>
									<option>请假申请</option>
									<option>资源申请</option>
									<option>用车申请</option>
									<option>请假申请</option>
									<option>资源申请</option>
									<option>用车申请</option>
									<option>请假申请</option>
									<option>资源申请</option>
								</select>
							</div>
						</div>
					</div>	
					<div class="layui-row text-right">
						<button class="layui-btn" lay-submit="" lay-filter="formDemo">确认</button>
						<span class="layui-btn layui-btn-primary" onclick="closePop()">返回</span>
					</div>
				</form>
			</div>
		</div>
		<script type="text/html" id="shenpi_html">
			<div class="layui-card shenpi_card">
				<div class="layui-card-header">审批人<i class="layui-icon layui-icon-close-fill fr fontsize-18" onclick="close_item(this)"></i></div>
				<div class="layui-card-body">
					<div class="show_div"><span class="text-85">请选择审批人</span></div>
					<label class="add_icon text-85">
						<i class="layui-icon layui-icon-right fr fontsize-18"></i>
						<input type="radio" name="add_item_point" lay-ignore  onclick="on_select(this)"/>
					</label>
				</div>
			</div>
			<div class="process_add_btn_item">
				<label>
					<i class="layui-icon layui-icon-add-circle" onclick="show_add_item(this)"></i>
					<input type="radio" name="add_item_point" lay-ignore />
				</label>
			</div>
		</script>
		<script type="text/html" id="chaosong_html">
			<div class="layui-card cahosong_card">
				<div class="layui-card-header">抄送人<i class="layui-icon layui-icon-close-fill fr fontsize-18" onclick="close_item(this)"></i></div>
				<div class="layui-card-body">
					<div class="show_div"><span class="text-85">请选择抄送人</span></div>
					<label class="add_icon text-85">
						<i class="layui-icon layui-icon-right fr fontsize-18"></i>
						<input type="radio" name="add_item_point" lay-ignore  onclick="on_select(this)"/>
					</label>
				</div>
			</div>
			<div class="process_add_btn_item">
				<label>
					<i class="layui-icon layui-icon-add-circle" onclick="show_add_item(this)"></i>
					<input type="radio" name="add_item_point" lay-ignore />
				</label>
			</div>
		</script>
		<div class="linePop linePop3" id="add_item" >
			<div class="layui-row add_item">
				<div class="layui-col-md6 text-center">
					<label href="javascript:;" onclick="add_item('shenpi')">
						<i class="layui-icon layui-icon-survey text-add"></i>
						<span>审批人</span>
					</label>
				</div>
				<div class="layui-col-md6 text-center">
					<label href="javascript:;" onclick="add_item('chaosong')">
						<i class="layui-icon layui-icon-release text-edit"></i>
						<span>抄送人</span>
					</label>
				</div>
			</div>
		</div>
		<div class="linePop linePop4" >
			<div class="layui-row add_item">
				<div class="layui-col-md6 text-center">
					<label href="javascript:;" onclick="user_popup(null,true,false,false,0,true)">
						<i class="layui-icon layui-icon-group text-add"></i>
						<span>指定成员</span>
					</label>
				</div>
				<div class="layui-col-md6 text-center">
					<label href="javascript:;" onclick="done_select('duty')">
						<i class="layui-icon layui-icon-friends text-edit"></i>
						<span>部门负责人</span>
					</label>
				</div>
			</div>
		</div>
		<div class="linePop linePop5" >
			<form class="layui-form layui-search-form">
				<div class="layui-row margin-t-10">
					<div class="search_item">
						<span>单号</span><input type="text" name="title" placeholder="请输入单号" autocomplete="off" class="layui-input">
					</div>
					<div class="search_item">
						<span>费用名称</span><input type="text" name="title" placeholder="请输入费用名称" autocomplete="off" class="layui-input">
					</div>
					<div class="search_item">
						<span>时间</span><input type="text" name="title" placeholder="请选择日期" autocomplete="off" class="layui-input" id="date1">
					</div>
					<div class="search_item">
						<button class="layui-btn layui-btn-normal">搜索</button>
					</div>	
				</div>
			</form>
			<table id="apply_lst" lay-filter="apply_lst"></table>
		</div>
		<script type="text/javascript">
			var layer_linePop,table;
			layui.use(['table','element','form','laydate'], function() {
				table = layui.table;
				var element = layui.element,
					form = layui.form,
					laydate = layui.laydate;
				lay('.date').each(function(){
					laydate.render({
						elem:this
					});
				});
				form.on('radio(pay_num)',function(obj){
					if(obj.value == 1){
						$("#pay_table_item").hide();
					} else {
						$("#pay_table_item").show();
					}
				});
				laydate.render({elem:'#date1'});
			});
			function add_group(){
				layer_linePop = layer.open({
					type: 1,
					title:'添加分组',
					String: false,
					closeBtn: 1,
					skin: 'layui-layer-rim',
					area: '750px',
					content: $('.linePop1')
				});
			}
			function process_move(){
				layer_linePop = layer.open({
					type: 1,
					title:'移动分组',
					String: false,
					closeBtn: 1,
					skin: 'layui-layer-rim',
					area: ['750px','450px'],
					content: $('.linePop2')
				});
			}
			function show_add_item(obj){
				layer_linePop = layer.open({
					type: 1,
					title:'添加流程项',
					String: false,
					closeBtn: 1,
					skin: 'layui-layer-rim',
					area: ['350px','160px'],
					content: $('.linePop3')
				});
			}
			function add_item(type){
				var html = $("#"+type+"_html").html();
				var p_li = $("input[name='add_item_point']:checked").parents('li');
				$(p_li).after('<li>'+html+'</li>');
				closePop();
			}
			function on_select(obj){
				/* layer_linePop = layer.open({
					type: 1,
					title:'选择人员类型',
					String: false,
					closeBtn: 1,
					skin: 'layui-layer-rim',
					area: ['350px','160px'],
					content: $('.linePop4')
				}); */
				user_popup2(null,true,true,true);
			}
			function done_select(type){
				if(type == 'duty'){//部门负责人
					var p_li = $("input[name='add_item_point']:checked").parents('li');
					$(p_li).find('.show_div').html('部门负责人');
				}
				closePop();
			}
			function close_item(obj){
				$(obj).parents('li').remove();
			}
			function show_search(){
				layer_linePop = layer.open({
					type: 1,
					title:'选择申请单',
					String: false,
					closeBtn: 1,
					btn:['确认','取消'],
					skin: 'layui-layer-rim',
					area: ['850px','450px'],
					content: $('.linePop5'),
					success:function(){
						table.render({
							elem:'#apply_lst',
							cols:[[
								{type:'radio','title':'序号'},
								{field:'no','title':'单号'},
								{field:'bm','title':'申请部门'},
								{field:'sqr','title':'申请人'},
								{field:'title','title':'费用名称'},
								{field:'date1','title':'申请日期'},
								{field:'date2','title':'审核日期'},
							]],
							data:[
								{'no':'1342353525',title:'物料费',date1:'2019-01-02',date2:'2019-01-02',bm:'销售部',sqr:'张三'},
								{'no':'1342353525',title:'物料费',date1:'2019-01-02',date2:'2019-01-02',bm:'销售部',sqr:'张三'},
								{'no':'1342353525',title:'物料费',date1:'2019-01-02',date2:'2019-01-02',bm:'销售部',sqr:'张三'},
							],
							height:'full-240',
							page:true
						});
					}
				});
			}
			function closePop(){
				layer.close(layer_linePop);
			}
		</script>
	</body>
</html>